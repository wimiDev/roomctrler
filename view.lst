C51 COMPILER V9.54   VIEW                                                                  04/30/2017 19:51:40 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE VIEW
OBJECT MODULE PLACED IN view.obj
COMPILER INVOKED BY: J:\program\keil\C51\BIN\C51.EXE class\view.c LARGE OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRIN
                    -T(.\view.lst) TABS(2) OBJECT(view.obj)

line level    source

   1          #include "view.h"
   2          
   3          unsigned char _page = 0;
   4          unsigned char lvsecond = 0;
   5          char trybee = 0;
   6          bit enablebee = 1;
   7          char msginval = 0;
   8          
   9          void showtimeval(DATE* time,char*name)
  10          {
*** WARNING C235 IN LINE 10 OF class\view.c: parameter 1: different types
  11   1         char str[20];
  12   1         sprintf(str,"[%d:%d:%d]",(int)time->hour,(int)time->min,(int)time->sec);
  13   1         LCDprintf(name,0);
  14   1         LCDprintf(str,-1);
  15   1      }
  16          void trunpage()
  17          {
  18   1        char key = -1;
  19   1        if(lvsecond == 0)
  20   1        {
  21   2          if(getkey(0)==15)
  22   2          {
  23   3          //ÉÏ·­Ò³
  24   3            _page++;
  25   3            if (_page >= MAXPAGE) _page = 0;
  26   3            beebee(1);
  27   3            LCDcls();
  28   3          }
  29   2          else if(getkey(0)==11)
  30   2          {
  31   3          //ÏÂ·­Ò³
  32   3            --_page;
  33   3            if (_page>MAXPAGE-1)  _page = MAXPAGE-1;
  34   3            beebee(1);
  35   3            LCDcls();
  36   3          }
  37   2          else
  38   2          {
  39   3      //      LCDcls();
  40   3      //      key = getkey(0);
  41   3      //      if(key >= 0)
  42   3      //      _page = getnumber(key) % MAXPAGE;
  43   3          }
  44   2        }
  45   1      }
  46          void uiupdater()
  47          {
  48   1        char sendstr[30];
  49   1        if(msgviewhandler()) return;
  50   1        trunpage();
  51   1        if (_page == 0)
  52   1        { 
  53   2          LCDprintf("--wellcom-----use----WIMI-DEV-",0);  
C51 COMPILER V9.54   VIEW                                                                  04/30/2017 19:51:40 PAGE 2   

  54   2        }
  55   1        else if (_page==1)
  56   1        {
  57   2          LCDprintf("-LIGS VAL-",0);
  58   2          sprintf(sendstr,"a:%d--b:%d--c:%d--d:%d",(int)paralist[0],
  59   2               (int)paralist[1],(int)paralist[2],(int)paralist[3]);
  60   2          LCDprintf(sendstr,-1);  
  61   2        }
  62   1        else if (_page==2)
  63   1        {
  64   2          if(lvsecond==0) showtimeval(&currenttime,"-TIME-NOW-");
  65   2          setcurrenttime();
  66   2        }
  67   1        else if(_page == 3)
  68   1        {
  69   2          setclosetime(&opentime);
  70   2          if(lvsecond==0) showtimeval(&opentime,"OPEN-TIME-");  
  71   2        }
  72   1        else if(_page == 4)
  73   1        {
  74   2          setclosetime(&closetime);
  75   2          if(lvsecond==0) showtimeval(&closetime,"-OFF-TIME-");
  76   2        } 
  77   1        else if(_page == 5)
  78   1        {
  79   2          if(lvsecond==0)showbeeable();
  80   2          setbeeanle();
  81   2        }
  82   1        else if(_page == 6)
  83   1        {
  84   2          showlightsta();
  85   2        }
  86   1        else if(_page == 7)
  87   1        {
  88   2      
  89   2          setlvoff_on();
  90   2        }
  91   1      
  92   1        getkey(1);
  93   1      }
  94          
  95          void beebee(char inval)
  96          {
  97   1        trybee = inval;
  98   1        beehandler();
  99   1      }
 100          void beehandler()
 101          {
 102   1          if(trybee > 0)
 103   1          {
 104   2            if(enablebee && trybee%2) _BEEBEE = 1;
 105   2            else _BEEBEE = 0; 
 106   2            trybee --;
 107   2          }
 108   1          else
 109   1          {
 110   2            _BEEBEE = 0;  
 111   2          }
 112   1      }
 113          void showbeeable()
 114          {
 115   1          char str[30];
C51 COMPILER V9.54   VIEW                                                                  04/30/2017 19:51:40 PAGE 3   

 116   1          if(enablebee)
 117   1          {
 118   2            sprintf(str,"BEE-ENABLE----ON----");
 119   2          }
 120   1          else
 121   1          {
 122   2            sprintf(str,"BEE-ENABLE----OFF---");
 123   2          }
 124   1          LCDprintf(str,0);
 125   1      }
 126          void showlightsta()
 127          {
 128   1          char str[30];
 129   1          char index=0;
 130   1          sprintf(str,"---LAMPS--");
 131   1          LCDprintf(str,0);
 132   1          for(index=0;index<3;index++)
 133   1          {
 134   2            if(lightstate[index])
 135   2            {
 136   3              sprintf(str,"%d:%c--",(int)index+1,'O');
 137   3              LCDprintf(str,-1);
 138   3            }
 139   2            else
 140   2            {
 141   3              sprintf(str,"%d:%c--",(int)index+1,'X');
 142   3              LCDprintf(str,-1);
 143   3            }
 144   2          }
 145   1      }
 146          void showmsg(char str[],char inval)
 147          {
 148   1        char msg[30];
 149   1        msginval = inval;
 150   1        sprintf(msg,"%s------%d",str,(int)msginval);
 151   1        LCDprintf(msg,0);
 152   1      }
 153          char msgviewhandler()
 154          {
 155   1        if(msginval > 0)
 156   1        {
 157   2          msginval--;
 158   2          //showmsg("",0);
 159   2          return 1;
 160   2        }
 161   1        if(msginval==0)
 162   1          { 
 163   2            LCDcls();
 164   2            msginval = -1;
 165   2          }
 166   1          return 0;
 167   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    895    ----
   CONSTANT SIZE    =    181    ----
   XDATA SIZE       =      4     151
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      1    ----
C51 COMPILER V9.54   VIEW                                                                  04/30/2017 19:51:40 PAGE 4   

END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  1 WARNING(S),  0 ERROR(S)
